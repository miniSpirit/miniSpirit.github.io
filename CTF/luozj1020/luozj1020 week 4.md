# week 4

# 2021-4-19

## signin

ä¸€çœ‹é¢˜ç›®ï¼Œç­¾åˆ°é¢˜
é™„ä»¶å†…å®¹ï¼š
welcome to crypto worldï¼ï¼
å¯†æ–‡ï¼š424a447b57653163306d655f74345f424a444354467d
å¯†æ–‡åå…­è¿›åˆ¶è½¬ç å°±è¡Œ
ä»£ç å¦‚ä¸‹ï¼š

```python
from Crypto.Util.number import *
s = '424a447b57653163306d655f74345f424a444354467d'
print(long_to_bytes(int(s, 16)))
```

## crypto-rsa0

æ‹¿åˆ°ä¸€ä¸ªå‹ç¼©åŒ…é™„ä»¶
è§£å‹çš„æ—¶å€™å‘ç°ï¼š
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210419220625214.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
å—¯ï¼Ÿä¸å¯¹åŠ²
å†æŠŠé‡Œé¢çš„å‹ç¼©åŒ…è§£å‹
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210419220717290.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
å—¯ï¼Ÿ
ç»™äº†ä¸€ä¸ªæç¤ºï¼šæ€ä¹ˆåŠå‘¢ï¼Œå‡ºé¢˜äººä¹Ÿå¤ªåäº†ï¼Œç«Ÿç„¶æŠŠå‹ç¼©åŒ…ç»™ä¼ªåŠ å¯†äº†ï¼
é¢ã€‚ã€‚ã€‚
ä»€ä¹ˆæ˜¯ä¼ªåŠ å¯†ï¼Ÿ
å‚è€ƒåšå®¢ï¼š[https://www.cnblogs.com/0yst3r-2046/p/11890498.html](https://www.cnblogs.com/0yst3r-2046/p/11890498.html)

é˜¿å·´é˜¿å·´é˜¿å·´
ç»¿è‰²æ¡†ä½çš„ 50 4B æ˜¯å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº ï¼Œå®ƒå¯¹åº”çš„ç»¿è‰²æ¡†æŸ±çš„ 09 00 å½±å“åŠ å¯†å±æ€§ï¼Œå½“æ•°å­—ä¸ºå¥‡æ•°æ˜¯ä¸ºåŠ å¯†ï¼Œä¸ºå¶æ•°æ—¶ä¸åŠ å¯†ã€‚
é˜¿å·´é˜¿å·´é˜¿å·´

å¥½å®¶ä¼™ï¼Œåªè¦æŠŠ 50 4B åé¢çš„ 09 00 æ”¹æˆå¶æ•°å°±è¡Œ

ç„¶åå°±ç¼ºå·¥å…·äº†
ç½‘ä¸Šä¸‹ winhex å„ç§å‡ºé—®é¢˜
ç»è¿‡å¤§ä½¬æŒ‡ç‚¹ï¼Œæäº† 010 editor çš„ç ´è§£ç‰ˆï¼ˆæ¬¸å˜¿å˜¿~ï¼‰
ç„¶åæœç´¢ 50 4B æŠŠåé¢çš„ 09 00 ä¿®æ”¹å³å¯
ä¸€ä¸ªå°æ’æ›²ï¼š
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210419221504127.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
è§£å‹ä¹‹åå¾—åˆ° RSA åŠ å¯†ä»£ç ï¼š

```python
from Cryptodome.Util.number import *
import random

FLAG=#hidden, please solve it
flag=int.from_bytes(FLAG,byteorder = 'big')


p=getPrime(512)
q=getPrime(512)

print(p)
print(q)
N=p*q
e=65537
enc = pow(flag,e,N)
print (enc)
```

å•Šè¿™ï¼Œp,q éƒ½å‘Šè¯‰äº†å—
ç›´æ¥è§£å¯†å°±è¡Œ
è§£å¯†ä»£ç å¦‚ä¸‹ï¼š

```python
from Crypto.Util.number import *

p = 9018588066434206377240277162476739271386240173088676526295315163990968347022922841299128274551482926490908399237153883494964743436193853978459947060210411
q = 7547005673877738257835729760037765213340036696350766324229143613179932145122130685778504062410137043635958208805698698169847293520149572605026492751740223
c = 50996206925961019415256003394743594106061473865032792073035954925875056079762626648452348856255575840166640519334862690063949316515750256545937498213476286637455803452890781264446030732369871044870359838568618176586206041055000297981733272816089806014400846392307742065559331874972274844992047849472203390350
e = 65537
n = p*q

phi = (p-1) * (q-1)
d = inverse(e, phi)
m = pow(c, d, n)
print(long_to_bytes(m))
```

ç»“æœä¸ºï¼šactf{n0w_y0u_see_RSA}

# 2021-4-20

## ä¸€å¼ è°æŠ¥

é¢˜ç›®ç»™äº†ä¸€ä»½æŠ¥çº¸
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210420225220955.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
å®Œå…¨æ‘¸ä¸ç€å¤´è„‘
åªèƒ½æ‰¾ [wp](https://blkstone.github.io/2017/12/17/dbappsec-ctf/)
flagï¼šå—å¤©è©è¨æ”¾é¹°æ‰çŒ´å¤´

## SameMod

å…±æ¨¡æ”»å‡»
ä¸å†èµ˜è¿°
è¯¦è§ CTFwiki [å…±æ¨¡æ”»å‡»](https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_module_attack/)
é¢˜ç›®ç»™çš„æ•°æ®éƒ½å’Œ CTFwiki çš„ä¸€æ¨¡ä¸€æ ·ï¼ˆå•Šè¿™ï¼‰
è§£å¯†ä»£ç å¦‚ä¸‹ï¼š

```python
import gmpy2

n = 6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249
e1 = 773
e2 = 839
message1=3453520592723443935451151545245025864232388871721682326408915024349804062041976702364728660682912396903968193981131553111537349
message2=5672818026816293344070119332536629619457163570036305296869053532293105379690793386019065754465292867769521736414170803238309535
# s & t
gcd, s, t = gmpy2.gcdext(e1, e2)
if s < 0:
    s = -s
    message1 = gmpy2.invert(message1, n)
if t < 0:
    t = -t
    message2 = gmpy2.invert(message2, n)
plain = gmpy2.powmod(message1, s, n) * gmpy2.powmod(message2, t, n) % n
i = 0
flag = ""
plain = str(plain)
while i < len(plain):
    if plain[i] == '1':
        flag += chr(int(plain[i:i + 3]))
        i += 3
    else:
        flag += chr(int(plain[i:i + 2]))
        i += 2
print(flag)
```

ç»“æœä¸ºï¼šflag{whenwethinkitispossible}

## BabyRSA

åŠ å¯†ä»£ç å¦‚ä¸‹ï¼š

```python
import hashlib
import sympy
from Crypto.Util.number import *

flag = 'GWHT{******}'
secret = '******'

assert(len(flag) == 38)

half = len(flag) / 2

flag1 = flag[:half]
flag2 = flag[half:]

secret_num = getPrime(1024) * bytes_to_long(secret)

p = sympy.nextprime(secret_num)
q = sympy.nextprime(p)

N = p * q

e = 0x10001

F1 = bytes_to_long(flag1)
F2 = bytes_to_long(flag2)

c1 = F1 + F2
c2 = pow(F1, 3) + pow(F2, 3)
assert(c2 < N)

m1 = pow(c1, e, N)
m2 = pow(c2, e, N)

output = open('secret', 'w')
output.write('N=' + str(N) + '\n')
output.write('m1=' + str(m1) + '\n')
output.write('m2=' + str(m2) + '\n')
output.close()
```

çœ‹æ¥æ˜¯æŠŠ flag åˆ†æˆä¸¤æ®µåŠ å¯†äº†
è¾“å‡ºæ•°æ®å¦‚ä¸‹ï¼š

```python
N=636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163
m1=90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239
m2=487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546
```

è€è§„çŸ©ï¼Œå…ˆè¯•è¯•èƒ½ä¸èƒ½çˆ†ç ´ N ï¼š
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210420233738222.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
å•Šè¿™
çˆ†ç ´å‡ºæ¥äº†
æ ¹æ® RSA çš„å¸¸è§„å¥—è·¯è§£å‡º c1, c2
ç”±äº
$$
c_{1} = f_{1} + f_{2} \\
c_{2} = f_{1}^{3} + f_{2}^{3}
$$
c2 åˆå¯ä»¥è¿›è¡Œå› å¼åˆ†è§£
$$
c_{2} = f_{1}^{3} + f_{2}^{3} = (f_{1} + f_{2} )(f_{1}^{2} - f_{1} f_{2} + f_{2}^{2})
$$
å°† $c_{1} = f_{1} + f_{2}$ ä»£å…¥å¾—
$$
\frac{c_{2}}{c_{1}} = f_{1}^{2} - f_{1} f_{2} + f_{2}^{2} = (f_{1} + f_{2} )^{2} - 3f_{1} f_{2}
$$
å¯ä»¥æ±‚å‡º $f_{1} f_{2}$ è®°ä¸º $c_{3}$
ç„¶åå¯ä»¥æ„é€ ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹
$$
x^{2} - c_{1}x + c_{3} = 0
$$
è§£å‡ºç»“æœå³ä¸º $f1,f2$
æœ€åè§£å¯†å³å¯
ä»£ç å¦‚ä¸‹ï¼š

```python
from Crypto.Util.number import *
from sympy import *

p = 797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377747699
q = 797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377748737
N = 636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163
m1= 90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239
m2 = 487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546
e = int('0x10001', 16)
phi = (p-1)*(q-1)
d = inverse(e, phi)
c1 = pow(m1, d, N) # f1 + f2
c2 = pow(m2, d, N) # f1^3 + f2^3
c3 = (c1**2 - c2//c1) // 3 # f1 * f2
x = symbols('x')
f1, f2 = solve(Eq(x**2 - c1*x + c3,0),x)
print(long_to_bytes(f2) + long_to_bytes(f1))
```

ç»“æœä¸ºï¼šGWHT{f709e0e2cfe7e530ca8972959a1033b2}

# 2021-4-21

## yxx

é¢˜ç›®ç»™äº†ä¸€ä¸ªå¯†æ–‡ã€ä¸€ä¸ªæ˜æ–‡
å¯†æ–‡ä¸€å †ä¹±ç 
æ˜æ–‡ï¼šlovelovelovelovelovelovelovelove
è”æƒ³åˆ°ä¹‹å‰åšè¿‡çš„ä¸€é“é¢˜ï¼š[å¼‚æ€§ç›¸å¸](https://blog.csdn.net/weixin_52446095/article/details/115464659?spm=1001.2014.3001.5501)
å¤§æ¦‚åˆæ˜¯è¦åšå¼‚æˆ–æ“ä½œ
ä»£ç å¦‚ä¸‹ï¼š

```python
key = 'lovelovelovelovelovelovelovelove'
with open(r'å¯†æ–‡.txt', 'r') as f:
    m = f.read()

c = ''
for i in range(len(m)):
    c += chr(ord(m[i]) ^ ord(key[i]))
print(c)
```

ç»“æœä¸ºï¼šflag:nctf{xor_xor_xor_biueiubiu}
ä½†æ˜¯æ€ä¹ˆéƒ½ä¸å¯¹
æ‰¾åˆ°å¤§ä½¬çš„ [wp](https://www.codeleading.com/article/51553078742/)
ç»“æœä¸ºï¼šflag:nctf{xor_xor_xor_biubiubiu}
å•Šè¿™
æ„Ÿè§‰ä¹Ÿæ²¡ä»€ä¹ˆä¸å¯¹çš„å•Š

## babyrsa

ä¸€é“éå¸¸åŸºç¡€çš„ RSA é¢˜
n ä¸é•¿ï¼Œå¯ä»¥çˆ†ç ´
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210421214054795.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
ä»£ç å¦‚ä¸‹ï¼š

```python
from Crypto.Util.number import *

c = 28767758880940662779934612526152562406674613203406706867456395986985664083182
n = 73069886771625642807435783661014062604264768481735145873508846925735521695159
e = 65537
p = 189239861511125143212536989589123569301
q = 386123125371923651191219869811293586459

phi = (p-1)*(q-1)
d = inverse(e, phi)
m = pow(c, d, n)
print(long_to_bytes(m))
```

ç»“æœä¸ºï¼šwctf2020{just_@_piece_0f_cak3}

## RSA4

é™„ä»¶ç»™äº†ä¸‰å¯¹ N å’Œ c
çŒœæµ‹æ˜¯å¹¿æ’­æ”»å‡»
ä½†æ˜¯ï¼Œæ€ä¹ˆæ²¡æœ‰ e
æœæ–­æ‰¾ [wp](https://blog.csdn.net/weixin_44017838/article/details/105058745)ï¼ˆæ“¦æ±—ï¼‰
å•Šè¿™
åŸæ¥ç»™çš„æ˜¯äº”è¿›åˆ¶æ•°å—
çŒœæƒ³ e=3 æ˜¯ä»€ä¹ˆæ“ä½œï¼Ÿ
ä¸è¿‡æ¯å¯¹ N å’Œ c éƒ½ç›¸å·®ä¸€ä½ï¼Œe ä¹Ÿä¸ä¼šè¾¾åˆ°å“ªå»å°±æ˜¯äº†ã€‚ã€‚ã€‚
è‡³äº CRT ç®—æ³•ï¼Œæ‡’å¾—å†™äº†ï¼Œç›´æ¥ç”¨ sagemath å°è£…å¥½çš„
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210421220158328.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
æ±‚å‡ºäº† m
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210421220221500.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
å¾—åˆ°ç»“æœ

# 2021-4-22

## æµªé‡Œæ·˜æ²™

é¢˜ç›®æè¿°ï¼š
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210422202220495.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
é™„ä»¶å†…å®¹ï¼š
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210422202243579.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
ä¸€è„¸æ‡µé€¼
ç­”æ¡ˆè§ [wp](https://blog.csdn.net/weixin_44017838/article/details/104888540)[doge]

## VigenÃ¨re

ç»´å‰å°¼äºšå¯†ç 
ä¸ç®¡ï¼Œç›´æ¥[çˆ†ç ´](https://www.guballa.de/vigenere-solver)
ç­”æ¡ˆï¼š
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210422202410305.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)

## è¿™æ˜¯ä»€ä¹ˆè§…ğŸ

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210422204405934.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
æ‰«äº†äºŒç»´ç ï¼Œä»€ä¹ˆéƒ½æ²¡å‘ç°
é™„ä»¶æ²¡æœ‰åç¼€
ç”¨ 010editor æ‰“å¼€
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210422204956382.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
å‘ç°æ˜¯ zip æ–‡ä»¶
åç¼€åæ”¹ä¸º .zip
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210422205124431.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70#pic_center)
å†…å®¹æ˜¯ä¸€å¼ å›¾ç‰‡
å³ä¸‹è§’çš„æ•°å­—å’Œå­—æ¯å®¹æ˜“çŒœæµ‹ä»£è¡¨
åˆ†åˆ«ä»£è¡¨æ—¥å†ä¸­çš„åˆ—å’Œè¡Œ
å¾—åˆ°çš„æ—¥æœŸï¼Œå¯¹åº”å­—æ¯è¡¨ä¸­çš„å­—æ¯
ç»“æœä¸º calendar

# 2021-4-23

## babyRSA

é¢˜ç›®åªç»™äº† e, d, c
æ ¹æ®åŠ å¯†ä»£ç ï¼š

```python
from Crypto.Util.number import *
from flag import flag

def nextPrime(n):
    n += 2 if n & 1 else 1
    while not isPrime(n):
        n += 2
    return n

p = getPrime(1024)
q = nextPrime(p)
n = p * q
e = 0x10001
d = inverse(e, (p-1) * (q-1))
c = pow(bytes_to_long(flag.encode()), e, n)

```

æˆ‘ä»¬å¾—çŸ¥ p æ˜¯ä¸€ä¸ª 1024 ä½çš„ç´ æ•°ï¼Œè€Œ q æ˜¯ p çš„ä¸‹ä¸€ä¸ªç´ æ•°
æ‰€ä»¥ï¼Œæ ¹æ®
$$
\varphi = (p-1)*(q-1)
$$
å¯ä»¥å¤§è‡´æ¨æ–­ $\varphi$ ä»‹äº $(2^{1023})^2$ ä¸ $(2^{1024})^2$ ä¹‹é—´
æ ¹æ®
$$
e * d \equiv 1 \space (mod \space \varphi)
$$
æ¨å‡º $\exists\space k \in\mathbb{Z}, \space s.t.$
$$
e * d = 1 +  k * \varphi
$$
å†è®¡ç®— $e * d - 1$ ï¼Œå‘ç°æ˜¯ä¸€ä¸ª 2066 ä½çš„æ•°
å¯ä»¥æ¨å‡º $k$ æ˜¯ä»‹äº $2^{15}$ ä¸ $2^{16}$ ä¹‹é—´çš„æ•°
æ®æ­¤å¯ä»¥çˆ†ç ´å‡º $k$ï¼Œç„¶åå¾—å‡º p, q ï¼Œå®Œæˆè§£å¯†
ä»£ç å¦‚ä¸‹ï¼š

```python
from Crypto.Util.number import *
from gmpy2 import *
from sympy import *

d = 19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913
c = 5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804
e = int('0x10001', 16)
kphi = e*d-1

print(len(bin(kphi)))
p = 0
q = 0
for k in range(pow(2, 15), pow(2, 16)):
    if kphi % k == 0:
        p = prevprime(iroot(kphi//k, 2)[0])
        q = nextprime(p)
        if (p-1)*(q-1)*k == kphi:
            break

n = p*q
m = pow(c, d, n)
print(long_to_bytes(m))
```

å‚è€ƒåšå®¢ï¼š[https://blog.csdn.net/weixin_45441024/article/details/110351394](https://blog.csdn.net/weixin_45441024/article/details/110351394)

## easyrsa

åŠ å¯†ä»£ç å¦‚ä¸‹ï¼š

```python
from Crypto.Util.number import getPrime,bytes_to_long
from sympy import Derivative
from fractions import Fraction
from secret import flag

p=getPrime(1024)
q=getPrime(1024)
e=65537
n=p*q
z=Fraction(1,Derivative(arctan(p),p))-Fraction(1,Derivative(arth(q),q))
m=bytes_to_long(flag)
c=pow(m,e,n)
print(c,z,n)
```

ç‰¹åˆ«çš„åœ°æ–¹å°±æ˜¯å¼•å…¥äº†ä¸€ä¸ª z
ä¸ç®¡ï¼Œå…ˆå°è¯•[çˆ†ç ´](http://factordb.com/) nï¼š
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210423201754971.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
å•Šè¿™
è®©æˆ‘çˆ†ç ´å‡ºæ¥äº†
ç„¶åå°±æ˜¯å¸¸è§„çš„ RSA æ“ä½œ
ä»£ç å¦‚ä¸‹ï¼š

```python
from Crypto.Util.number import *

p = 105909195259921349656664570904199242969110902804477734660927330311460997899731622163728968380757294196277263615386525795293086103142131020215128282050307177125962302515483190468569376643751587606016315185736245896434947691528567696271911398179288329609207435393579332931583829355558784305002360873458907029141
q = 144564833334456076455156647979862690498796694770100520405218930055633597500009574663803955456004439398699669751249623406199542605271188909145969364476344963078599240058180033000440459281558347909876143313940657252737586803051935392596519226965519859474501391969755712097119163926672753588797180811711004203301
n = 15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441
c = 7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035
e = 65537

phi = (p-1)*(q-1)
d = inverse(e, phi)
m = pow(c, d, n)
print(long_to_bytes(m))
```

å›è¿‡æ¥æˆ‘ä»¬æ£æµ‹å‡ºé¢˜äººå¼•å…¥ $z$ çš„æ„å›¾
é¦–å…ˆ
$$
z = \frac{1}{\frac{d(arctan(p))}{dp}} + \frac{1}{\frac{d(arth(q))}{dq}}
$$
åˆå› ä¸ºåæ­£åˆ‡å‡½æ•°å’ŒååŒæ›²æ­£åˆ‡å‡½æ•°çš„å¯¼æ•°åˆ†åˆ«ä¸ºï¼š
$$
\frac{d(arctan(x))}{dx} = \frac{1}{1 + x^{2}},\\
\frac{d(arth(x))}{dx} = \frac{1}{1 - x^{2}}
$$
æ‰€ä»¥
$$
z = \frac{1}{\frac{1}{1 + p^{2}}} + \frac{1}{\frac{1}{1 - q^{2}}}=p^{2} + q^{2}
$$
åˆå› ä¸º $n = p*q$ï¼Œæˆ‘ä»¬å¯ä»¥æ±‚å‡º $p + q$
å†æ ¹æ®
$$
\varphi = (p-1)*(q-1) = p*q - p - q + 1 = n - (p+q) + 1
$$
å¯ä»¥æ±‚å‡º $\varphi$
ç„¶åè¿›è¡Œè§£å¯†
ä»£ç å¦‚ä¸‹ï¼š

```python
from gmpy2 import *
from Crypto.Util.number import *

n = 15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441
c = 7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035
z = 32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482
e = 65537

p_q = iroot(z + 2*n, 2)[0] # p+q
phi = n - p_q + 1
d = inverse(e, phi)
m = pow(c, d, n)
print(long_to_bytes(m))
```

ç»“æœä¸ºï¼šBJD{Advanced_mathematics_is_too_hard!!!}

# 2021-4-24

## ä½ èƒ½çœ‹å‡ºè¿™æ˜¯ä»€ä¹ˆåŠ å¯†ä¹ˆ

é™„ä»¶å†…å®¹å¦‚ä¸‹ï¼š
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210424212602804.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
è¿™ä¸ä¸€çœ‹å°±æ˜¯ RSA å˜›
å¤åˆ¶ç²˜è´´ä¹‹åï¼š
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210424212711945.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
å—¯ï¼Ÿ
æ€ä¹ˆåé¢è¿˜æœ‰ä¹±ç ï¼Ÿ
ä¸ç®¡ï¼Œå…ˆåˆ äº†è¯•è¯•çœ‹èƒ½æŠŠä¹Ÿèƒ½è§£å¯†
ä»£ç å¦‚ä¸‹ï¼š

```python
from Crypto.Util.number import *

p = int('0x928fb6aa9d813b6c3270131818a7c54edb18e3806942b88670106c1821e0326364194a8c49392849432b37632f0abe3f3c52e909b939c91c50e41a7b8cd00c67d6743b4f', 16)
q = int('0xec301417ccdffa679a8dcc4027dd0d75baf9d441625ed8930472165717f4732884c33f25d4ee6a6c9ae6c44aedad039b0b72cf42cab7f80d32b74061', 16)
e = int('0x10001', 16)
c = int('0x70c9133e1647e95c3cb99bd998a9028b5bf492929725a9e8e6d2e277fa0f37205580b196e5f121a2e83bc80a8204c99f5036a07c8cf6f96c420369b4161d2654a7eccbdaf583204b645e137b3bd15c5ce865298416fd5831cba0d947113ed5be5426b708b89451934d11f9aed9085b48b729449e461ff0863552149b965e22b6', 16)

n = p*q
phi = (p-1)*(q-1)
d = inverse(e, phi)
m = pow(c, d, n)
print(long_to_bytes(m))
```

ç»“æœä¸ºï¼š
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210424212821672.png)
å—¯ï¼Ÿ
ä¸€å †ä¹±ç 
ç¿»åˆ°æœ€åå‘ç°ï¼š
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210424212854763.png)
å•Šè¿™
ç»“æœå°±æ˜¯ï¼šafctf{R54_|5_\$0_\$imp13}

## crypto-rsa3

æ™®é€šçš„ RSA
n ä¸é•¿ï¼Œå¯ä»¥ç›´æ¥[çˆ†ç ´](http://factordb.com/)
ç»“æœä¸ºï¼š
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210424213134863.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
ç„¶åè§£å¯†å³å¯
ä»£ç å¦‚ä¸‹ï¼š

```python
from Crypto.Util.number import *

e = 65537
n = 177606504836499246970959030226871608885969321778211051080524634084516973331441644993898029573612290095853069264036530459253652875586267946877831055147546910227100566496658148381834683037366134553848011903251252726474047661274223137727688689535823533046778793131902143444408735610821167838717488859902242863683
c = 1457390378511382354771000540945361168984775052693073641682375071407490851289703070905749525830483035988737117653971428424612332020925926617395558868160380601912498299922825914229510166957910451841730028919883807634489834128830801407228447221775264711349928156290102782374379406719292116047581560530382210049
p = 13326909050357447643526585836833969378078147057723054701432842192988717649385731430095055622303549577233495793715580004801634268505725255565021519817179231
q = 13326909050357447643526585836833969378078147057723054701432842192988717649385731430095055622303549577233495793715580004801634268505725255565021519817179293

phi = (p-1)*(q-1)
d = inverse(e, phi)
m = pow(c, d, n)
print(long_to_bytes(m))
```

ç»“æœä¸ºï¼šactf{p_and_q_should_not_be_so_close_in_value}

# 2021-4-25

## é¸¡è—•æ¤’ç›å‘³

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210425223305213.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
ä»€ä¹ˆç©æ„ï¼Ÿ
ç›´æ¥æ‰¾ [wp](https://www.dazhuanlan.com/2019/12/17/5df7e64bc03b2/)ï¼ˆ
åŸæ¥â€œé¸¡è—•æ¤’ç›å‘³â€æ˜¯â€œå¥‡å¶æ ¡éªŒä½â€çš„è°éŸ³
ç„¶åç”¨æ±‰æ˜ç è¿˜åŸæœ€åmd5
[ä»£ç ](https://blog.csdn.net/weixin_44017838/article/details/104889490)

## crypto-classic0

æ‹¿åˆ°é™„ä»¶è§£å‹
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/2021042523210447.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
å—¯ï¼Ÿ
æ²¡è§£å‹å®Œï¼Ÿ
éš¾é“åˆæ˜¯ä¼ªåŠ å¯†ï¼Ÿ
ç”¨ 010editor çœ‹äº†ä¹‹åï¼Œä¹Ÿæ²¡æœ‰ä¼ªåŠ å¯†çš„ç‰¹å¾å•Š
é‡Œé¢è¿˜æœ‰ä¸ªå‹ç¼©åŒ…è¦å¯†ç 
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210425232245660.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
ç»™äº†ä¸ªæç¤º
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210425232321333.png)
è¿˜æ˜¯æ‘¸ä¸ç€å¤´è„‘
åªèƒ½æ‰¾ [wp](https://blog.csdn.net/seven749/article/details/109606928)ï¼ˆ
ç»“æœæ˜¯ä¸ªå·¥å…·é¢˜
è¦ç”¨ ziperello çˆ†ç ´
ä½†æ˜¯æ‰¾äº†åŠå¤©æ‰¾ä¸åˆ°éƒ½ä¸‹è½½å¤±è´¥äº†ï¼ˆ
ç„¶ååœ¨ [bç«™ä¸Š](https://www.bilibili.com/video/BV1EK4y187WG?from=search&seid=579101326676298682)ï¼Œæ‰¾åˆ°äº†è¿™ä¹ˆä¸€ä¸ª[é“¾æ¥](https://ww.lanzous.com/icug02f)
æ‰¾åˆ°äº†ä¸€ä¸ªä»£æ›¿çš„è½¯ä»¶
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210425232722549.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
çˆ†ç ´å‡ºå¯†ç 
åŠ å¯†ä»£ç ä¸ºï¼š

```c
#include<stdio.h>

char flag[25] = ***

int main()
{
	int i;
	for(i=0;i<25;i++)
	{
		flag[i] -= 3;
		flag[i] ^= 0x7;
		printf("%c",flag[i]);
	}
	return 0; 
}
```

æ ¹æ®åŠ å¯†ä»£ç å†™è§£å¯†ä»£ç å³å¯
ä»£ç å¦‚ä¸‹ï¼š

```c
#include<stdio.h>

char flag[25] = "Ygvdmq[lYate[elghqvakl}";

int main()
{
	int i;
	for(i=0;i<25;i++)
	{
        flag[i] ^= 0x7;
		flag[i] += 3;
		printf("%c",flag[i]);
	}
	return 0; 
}
```

ç»“æœä¸ºï¼šactf{my_naive_encrytion}